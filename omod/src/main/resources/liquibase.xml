<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
	<changeSet id="openhmis.inventory-v1.0-1" author="ibewes">
		<createTable tableName="inv_item">
			<column name="item_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>

			<column name="name" type="varchar(255)" defaultValue="" ><constraints nullable="false"/></column>
			<column name="description" type="varchar(1024)" defaultValue=""/>
			<column name="department_id" type="int"><constraints nullable="false" /></column>
			<column name="category_id" type="int" />
			<column name="default_price_id" type="int" />
			<column name="has_expiration" type="BOOLEAN" defaultValueBoolean="false" ><constraints nullable="false"/></column>

			<column name="creator" type="int" defaultValueNumeric="0" ><constraints nullable="false"/></column>
			<column name="date_created" type="DATETIME"><constraints nullable="false"/></column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN"><constraints nullable="false"/></column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_item_attribute_type">
			<column name="item_attribute_type_id" type="int" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="name" type="varchar(255)"><constraints nullable="false" /></column>
			<column name="description" type="varchar(1024)" />
			<column name="datatype" type="varchar(255)" />
			<column name="datatype_config" type="text" />
			<column name="preferred_handler" type="varchar(255)" />
			<column name="handler_config" type="text" />
			<column name="min_occurs" type="int"><constraints nullable="false" /></column>
			<column name="max_occurs" type="int"/>
			<column name="creator" type="int"><constraints nullable="false" /></column>
			<column name="date_created" type="datetime"><constraints nullable="false" /></column>
			<column name="changed_by" type="int" />
			<column name="date_changed" type="datetime" />
			<column name="retired" type="boolean" defaultValueBoolean="false"><constraints nullable="false" /></column>
			<column name="retired_by" type="int" />
			<column name="date_retired" type="datetime" />
			<column name="retire_reason" type="varchar(255)" defaultValue="null" />
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_item_attribute">
			<column name="item_attribute_id" type="int" autoIncrement="true">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="item_id" type="int"><constraints nullable="false" /></column>
			<column name="item_attribute_type_id" type="int"><constraints nullable="false" /></column>
			<column name="value_reference" type="text"><constraints nullable="false" /></column>
			<column name="creator" type="int"><constraints nullable="false"/></column>
			<column name="date_created" type="datetime"><constraints nullable="false"/></column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="datetime" />
			<column name="voided" type="boolean" defaultValueBoolean="false"><constraints nullable="false"/></column>
			<column name="voided_by" type="int" />
			<column name="date_voided" type="datetime" />
			<column name="void_reason" type="varchar(255)" defaultValue="null"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_item_price">
			<column name="item_price_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="item_id" type="int"><constraints nullable="false"/></column>
			<column name="price" type="decimal(10,2)"><constraints nullable="false"/></column>

			<column defaultValue="" name="name" type="varchar(255)" />
			<column defaultValue="" name="description" type="varchar(1024)" />

			<column name="creator" type="int" defaultValueNumeric="0" ><constraints nullable="false"/></column>
			<column name="date_created" type="DATETIME"><constraints nullable="false"/></column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN"><constraints nullable="false"/></column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_item_code">
			<column name="item_code_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true" />
			</column>
			<column name="item_id" type="int">
				<constraints nullable="false"/>
			</column>
			<column name="code" type="varchar(255)">
				<constraints nullable="false"/>
			</column>

			<column defaultValue="" name="name" type="varchar(255)" />
			<column defaultValue="" name="description" type="varchar(1024)" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_department">
			<column name="department_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column defaultValue="" name="name" type="varchar(255)"><constraints nullable="false"/></column>
			<column defaultValue="" name="description" type="varchar(1024)" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_category">
			<column name="category_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column defaultValue="" name="name" type="varchar(255)"><constraints nullable="false"/></column>
			<column defaultValue="" name="description" type="varchar(1024)" />
			<column name="parent_id" type="int" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room">
			<column name="stock_room_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column defaultValue="" name="name" type="varchar(255)"><constraints nullable="false"/></column>
			<column defaultValue="" name="description" type="varchar(1024)" />
			<column name="location_id" type="int" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_item">
			<column name="stock_room_item_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="stock_room_id" type="int"><constraints nullable="false" /></column>
			<column name="import_transaction_id" type="int"><constraints nullable="false" /></column>
			<column name="item_id" type="int"><constraints nullable="false" /></column>
			<column name="quantity" type="int"><constraints nullable="false"/></column>
			<column name="expiration" type="DATE" />
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transaction">
			<column name="stock_room_transaction_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>

			<column name="transaction_number" type="varchar(50)"><constraints nullable="false" /></column>
			<column name="transaction_type_id" type="int"><constraints nullable="false" /></column>
			<column name="status" type="varchar(50)"><constraints nullable="false" /></column>
			<column name="stock_room_source_id" type="int"/>
			<column name="stock_room_destination_id" type="int" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transaction_item">
			<column name="stock_room_transaction_item_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>

			<column name="transaction_id" type="int"><constraints nullable="false" /></column>
			<column name="import_transaction_id" type="int"><constraints nullable="false" /></column>
			<column name="item_id" type="int"><constraints nullable="false" /></column>
			<column name="quantity_ordered" type="int"><constraints nullable="false" /></column>
			<column name="quantity_transferred" type="int" />
			<column name="quantity_reserved" type="int" />
			<column name="expiration" type="DATE" />
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transaction_type">
			<column name="stock_room_transaction_type_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column defaultValue="" name="name" type="varchar(255)"><constraints nullable="false"/></column>
			<column defaultValue="" name="description" type="varchar(1024)" />

			<column name="quantity_type" type="varchar(50)"><constraints nullable="false" /></column>
			<column name="source_required" type="boolean" defaultValueBoolean="false" />
			<column name="destination_required" type="boolean" defaultValueBoolean="false" />
			<column name="authorized" type="boolean" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transaction_type_attribute_type">
			<column name="stock_room_transaction_type_attribute_type_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column defaultValue="" name="name" type="varchar(255)"><constraints nullable="false"/></column>
			<column defaultValue="" name="description" type="varchar(1024)" />

			<column name="transaction_type_id" type="int"><constraints nullable="false"/></column>
			<column name="attribute_order" type="int"><constraints nullable="false" /></column>
			<column name="format" type="varchar(255)" />
			<column name="foreign_key" type="int" />
			<column name="reg_exp" type="varchar(255)" />
			<column name="required" type="boolean" defaultValueBoolean="false" />
			<column name="user_id" type="int" />
			<column name="role" type="varchar(50)" />
			<column name="patient_id" type="int" />

			<column name="creator" type="int" defaultValueNumeric="0" >
				<constraints nullable="false"/>
			</column>
			<column name="date_created" type="DATETIME">
				<constraints nullable="false"/>
			</column>
			<column name="changed_by" type="int"/>
			<column name="date_changed" type="DATETIME"/>
			<column defaultValueBoolean="false" name="retired" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
			<column name="retired_by" type="int"/>
			<column name="date_retired" type="DATETIME"/>
			<column name="retire_reason" type="varchar(255)"/>
			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transaction_attribute">
			<column name="stock_room_transaction_attribute_id" autoIncrement="true" type="int">
				<constraints nullable="false" primaryKey="true"/>
			</column>
			<column name="transaction_id" type="int"><constraints nullable="false" /></column>
			<column name="attribute_type_id" type="int"><constraints nullable="false" /></column>
			<column name="value_reference" type="text"><constraints nullable="false" /></column>

			<column name="uuid" type="char(38)"><constraints nullable="false" unique="true" /></column>
		</createTable>
		<createTable tableName="inv_stock_room_transactions">
			<column name="stock_room_id" type="int"><constraints nullable="false" primaryKey="true" /></column>
			<column name="transaction_id" type="int"><constraints nullable="false" primaryKey="true" /></column>
		</createTable>

		<createIndex indexName="inv_item_name_idx" tableName="inv_item" unique="false">
			<column name="name"/>
			<column name="retired" />
		</createIndex>
		<createIndex indexName="inv_item_department_name_idx" tableName="inv_item" unique="false">
			<column name="department_id" />
			<column name="name"/>
			<column name="retired" />
		</createIndex>
		<createIndex indexName="inv_item_category_name_idx" tableName="inv_item" unique="false">
			<column name="category_id" />
			<column name="name"/>
			<column name="retired" />
		</createIndex>
		<createIndex indexName="inv_category_parent_idx" tableName="inv_category" unique="false">
			<column name="parent_id"/>
			<column name="retired" />
		</createIndex>
		<createIndex indexName="inv_stock_room_item_item_idx" tableName="inv_stock_room_item" unique="true">
			<column name="stock_room_id"/>
			<column name="item_id" />
		</createIndex>
		<createIndex indexName="inv_sr_tt_attribute_type_idx" tableName="inv_stock_room_transaction_type_attribute_type" unique="false">
			<column name="transaction_type_id"/>
			<column name="attribute_order" />
		</createIndex>
		<createIndex indexName="inv_sr_transaction_attribute_idx" tableName="inv_stock_room_transaction_attribute" unique="false">
			<column name="transaction_id"/>
			<column name="attribute_type_id" />
		</createIndex>
		<createIndex tableName="inv_stock_room_transactions" indexName="inv_stock_room_transactions_idx" unique="true">
			<column name="stock_room_id" />
			<column name="transaction_id" />
		</createIndex>

		<addForeignKeyConstraint constraintName="inv_item_creator_fk"
	                             baseTableName="inv_item" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"
		                         deferrable="false" initiallyDeferred="false" />
		<addForeignKeyConstraint constraintName="inv_item_changed_by_fk"
		                         baseTableName="inv_item" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"
		                         deferrable="false" initiallyDeferred="false" />
		<addForeignKeyConstraint constraintName="inv_item_retired_by_fk"
		                         baseTableName="inv_item" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"
		                         deferrable="false" initiallyDeferred="false" />
		<addForeignKeyConstraint constraintName="inv_item_department_fk"
		                         baseTableName="inv_item" baseColumnNames="department_id"
		                         referencedTableName="inv_department" referencedColumnNames="department_id"
		                         deferrable="false" initiallyDeferred="false" />
		<addForeignKeyConstraint constraintName="inv_item_category_fk"
		                         baseTableName="inv_item" baseColumnNames="category_id"
		                         referencedTableName="inv_category" referencedColumnNames="category_id"
		                         deferrable="false" initiallyDeferred="false" />

		<addForeignKeyConstraint constraintName="inv_item_attribute_type_creator_fk"
		                         baseTableName="inv_item_attribute_type" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_attribute_type_changed_by_fk"
		                         baseTableName="inv_item_attribute_type" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_attribute_type_retired_by_fk"
		                         baseTableName="inv_item_attribute_type" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_item_attribute_attribute_type_id_fk"
		                         baseTableName="inv_item_attribute" baseColumnNames="item_attribute_type_id"
		                         referencedTableName="inv_item_attribute_type" referencedColumnNames="item_attribute_type_id" />
		<addForeignKeyConstraint constraintName="inv_item_attribute_item_id_fk"
		                         baseTableName="inv_item_attribute" baseColumnNames="item_id"
		                         referencedTableName="inv_item" referencedColumnNames="item_id"
		                         onDelete="CASCADE" onUpdate="CASCADE"/>
		<addForeignKeyConstraint constraintName="inv_item_attribute_creator_fk"
		                         baseTableName="inv_item_attribute" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_attribute_changed_by_fk"
		                         baseTableName="inv_item_attribute" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_attribute_voided_by_fk"
		                         baseTableName="inv_item_attribute" baseColumnNames="voided_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_item_price_item_id_fk"
		                         baseTableName="inv_item_price" baseColumnNames="item_id"
		                         referencedTableName="inv_item" referencedColumnNames="item_id"
		                         onDelete="CASCADE" onUpdate="CASCADE"/>
		<addForeignKeyConstraint constraintName="inv_item_price_creator_fk"
		                         baseTableName="inv_item_price" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_price_changed_by_fk"
		                         baseTableName="inv_item_price" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_price_retired_by_fk"
		                         baseTableName="inv_item_price" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_item_code_item_id_fk"
		                         baseTableName="inv_item_code" baseColumnNames="item_id"
		                         referencedTableName="inv_item" referencedColumnNames="item_id"
		                         onDelete="CASCADE" onUpdate="CASCADE" />
		<addForeignKeyConstraint constraintName="inv_item_code_creator_fk"
		                         baseTableName="inv_item_code" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_code_changed_by_fk"
		                         baseTableName="inv_item_code" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_item_code_retired_by_fk"
		                         baseTableName="inv_item_code" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_department_creator_fk"
		                         baseTableName="inv_department" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_department_changed_by_fk"
		                         baseTableName="inv_department" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_department_retired_by_fk"
		                         baseTableName="inv_department" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_category_creator_fk"
		                         baseTableName="inv_category" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_category_changed_by_fk"
		                         baseTableName="inv_category" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_category_retired_by_fk"
		                         baseTableName="inv_category" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_category_parent_fk"
		                         baseTableName="inv_category" baseColumnNames="parent_id"
		                         referencedTableName="inv_category" referencedColumnNames="category_id"
		                         onDelete="CASCADE" onUpdate="CASCADE"/>

		<addForeignKeyConstraint constraintName="inv_stock_room_location_fk"
		                         baseTableName="inv_stock_room" baseColumnNames="location_id"
		                         referencedTableName="location" referencedColumnNames="location_id"/>
		<addForeignKeyConstraint constraintName="inv_stock_room_creator_fk"
		                         baseTableName="inv_stock_room" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_stock_room_changed_by_fk"
		                         baseTableName="inv_stock_room" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_stock_room_retired_by_fk"
		                         baseTableName="inv_stock_room" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_stock_room_item_stock_room_fk"
		                         baseTableName="inv_stock_room_item" baseColumnNames="stock_room_id"
		                         referencedTableName="inv_stock_room" referencedColumnNames="stock_room_id"/>
		<addForeignKeyConstraint constraintName="inv_stock_room_item_item_fk"
		                         baseTableName="inv_stock_room_item" baseColumnNames="item_id"
		                         referencedTableName="inv_item" referencedColumnNames="item_id"/>
		<addForeignKeyConstraint constraintName="inv_stock_room_item_import_transaction_fk"
		                         baseTableName="inv_stock_room_item" baseColumnNames="import_transaction_id"
		                         referencedTableName="inv_stock_room_transaction" referencedColumnNames="stock_room_transaction_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_transaction_transfer_type_fk"
		                         baseTableName="inv_stock_room_transaction" baseColumnNames="transaction_type_id"
		                         referencedTableName="inv_stock_room_transaction_type" referencedColumnNames="stock_room_transaction_type_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_source_fk"
		                         baseTableName="inv_stock_room_transaction" baseColumnNames="stock_room_source_id"
		                         referencedTableName="inv_stock_room" referencedColumnNames="stock_room_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_destination_fk"
		                         baseTableName="inv_stock_room_transaction" baseColumnNames="stock_room_destination_id"
		                         referencedTableName="inv_stock_room" referencedColumnNames="stock_room_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_creator_fk"
		                         baseTableName="inv_stock_room_transaction" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_transaction_item_transaction_fk"
		                         baseTableName="inv_stock_room_transaction_item" baseColumnNames="transaction_id"
		                         referencedTableName="inv_stock_room_transaction" referencedColumnNames="stock_room_transaction_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_item_import_transaction_fk"
		                         baseTableName="inv_stock_room_transaction_item" baseColumnNames="import_transaction_id"
		                         referencedTableName="inv_stock_room_transaction" referencedColumnNames="stock_room_transaction_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_item_item_fk"
		                         baseTableName="inv_stock_room_transaction_item" baseColumnNames="item_id"
		                         referencedTableName="inv_item" referencedColumnNames="item_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_transaction_type_creator_fk"
		                         baseTableName="inv_stock_room_transaction_type" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_type_changed_by_fk"
		                         baseTableName="inv_stock_room_transaction_type" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_type_retired_by_fk"
		                         baseTableName="inv_stock_room_transaction_type" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_transaction_type_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="transaction_type_id"
		                         referencedTableName="inv_stock_room_transaction_type" referencedColumnNames="stock_room_transaction_type_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_user_id_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="user_id"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_role_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="role"
		                         referencedTableName="role" referencedColumnNames="role"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_patient_id_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="patient_id"
		                         referencedTableName="patient" referencedColumnNames="patient_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_creator_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="creator"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_changed_by_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="changed_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_tt_attribute_type_retired_by_fk"
		                         baseTableName="inv_stock_room_transaction_type_attribute_type" baseColumnNames="retired_by"
		                         referencedTableName="users" referencedColumnNames="user_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_transaction_attribute_transaction_fk"
		                         baseTableName="inv_stock_room_transaction_attribute" baseColumnNames="transaction_id"
		                         referencedTableName="inv_stock_room_transaction" referencedColumnNames="stock_room_transaction_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transaction_attribute_attribute_type_fk"
		                         baseTableName="inv_stock_room_transaction_attribute" baseColumnNames="attribute_type_id"
		                         referencedTableName="inv_stock_room_transaction_type_attribute_type" referencedColumnNames="stock_room_transaction_type_attribute_type_id"/>

		<addForeignKeyConstraint constraintName="inv_sr_transactions_stock_room_fk"
		                         baseTableName="inv_stock_room_transactions" baseColumnNames="stock_room_id"
		                         referencedTableName="inv_stock_room" referencedColumnNames="stock_room_id"/>
		<addForeignKeyConstraint constraintName="inv_sr_transactions_transaction_fk"
		                         baseTableName="inv_stock_room_transactions" baseColumnNames="transaction_id"
		                         referencedTableName="inv_stock_room_transaction" referencedColumnNames="stock_room_transaction_id"/>

		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Initial</column>
			<column name="description">Transaction to record the initial item stock quantities.</column>
			<column name="quantity_type">TRANSFERRED</column>
			<column name="source_required">0</column>
			<column name="destination_required">1</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">2f2e072a-9c72-41d8-b1d0-ab50c01b6e4d</column>
		</insert>
		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Intake</column>
			<column name="description">Transaction to acquire items from an outside supplier.</column>
			<column name="quantity_type">RESERVED</column>
			<column name="source_required">0</column>
			<column name="destination_required">1</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">8eb783b4-260b-43fd-ab83-2d3c413bfa56</column>
		</insert>
		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Transfer</column>
			<column name="description">Transaction to transfer items from one stock room to another.</column>
			<column name="quantity_type">TRANSFERRED</column>
			<column name="source_required">1</column>
			<column name="destination_required">1</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">b61cabfb-93e9-4cab-97a2-3b682cdb8c96</column>
		</insert>
		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Distribution</column>
			<column name="description">Transaction to distribute items to a patient or other outside destination.</column>
			<column name="quantity_type">RESERVED</column>
			<column name="source_required">1</column>
			<column name="destination_required">0</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">09bdbc0c-306d-484e-8a0e-61811152a1d8</column>
		</insert>
		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Correction</column>
			<column name="description">Transaction to update item quantity to reflect current stock.</column>
			<column name="quantity_type">TRANSFERRED</column>
			<column name="source_required">1</column>
			<column name="destination_required">1</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">b20c2a24-29e4-405a-9e56-054351cbf5f7</column>
		</insert>
		<insert tableName="inv_stock_room_transaction_type">
			<column name="name">Expiration</column>
			<column name="description">Transaction to remove items from stock because they have expired.</column>
			<column name="quantity_type">RESERVED</column>
			<column name="source_required">1</column>
			<column name="destination_required">0</column>
			<column name="authorized">0</column>
			<column name="creator">1</column>
			<column name="date_created">2013-01-01</column>
			<column name="uuid">c4f258a9-8ed2-4faf-b4ab-e3894c5d1c60</column>
		</insert>
	</changeSet>
	<changeSet id="openhmis.inventory-v1.0-2" author="ibewes">
		<addColumn tableName="inv_item">
			<column name="concept_id" type="int" />
			<column name="drug_id" type="int" />
		</addColumn>

		<addForeignKeyConstraint constraintName="inv_item_concept_id_fk"
		                         baseTableName="inv_item" baseColumnNames="concept_id"
		                         referencedTableName="concept" referencedColumnNames="concept_id"/>
		<addForeignKeyConstraint constraintName="inv_item_drug_id_fk"
		                         baseTableName="inv_item" baseColumnNames="drug_id"
		                         referencedTableName="drug" referencedColumnNames="drug_id"/>
	</changeSet>
	<changeSet id="openhmis.inventory-v1.0-3" author="ibewes">
		<modifyColumn tableName="inv_stock_room_transaction">
			<column name="transaction_number"  type="varchar(50)"><constraints nullable="true"/></column>
		</modifyColumn>
	</changeSet>
	<changeSet id="openhmis.inventory-v1.0.4" author="ibewes">
		<addColumn tableName="inv_stock_room_transaction">
			<column defaultValueBoolean="false" name="is_import_transaction" type="BOOLEAN">
				<constraints nullable="false"/>
			</column>
		</addColumn>
	</changeSet>
</databaseChangeLog>